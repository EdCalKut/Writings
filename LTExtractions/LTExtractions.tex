\documentclass[11pt]{amsart}

\usepackage{geometry}  
\geometry{letterpaper} 
\usepackage{graphicx}
%\usepackage[backend=bibtex]{biblatex}
\usepackage{array}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{graphicx}
\usepackage[parfill]{parskip} 
\usepackage[utf8]{inputenc}
\usepackage[english]{babel}
\usepackage{tikz}
\usepackage{tikz-cd}
\usepackage[noend]{algpseudocode}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{fancyhdr}
\usepackage{enumitem}
\usepackage[super]{nth}
\usepackage{pstricks}
\usepackage{comment}

\usepackage[colorlinks=true,linkcolor=blue]{hyperref}


\pagestyle{fancy}
\lhead{}
\chead{}
\rhead{}
\lfoot{}
\cfoot{\thepage}
\rfoot{}
\renewcommand{\headrulewidth}{0pt}
\setlength{\footskip}{50pt}

\makeatletter
\def\BState{\State\hskip-\ALG@thistlm}
\makeatother

\theoremstyle{definition}
\newtheorem{thm}{Theorem}[section]
\theoremstyle{definition}
\newtheorem{cor}[thm]{Corollary}
\theoremstyle{definition}
\newtheorem{prop}[thm]{Proposition}
\theoremstyle{definition}
\newtheorem{dfn}[thm]{Definition}
\theoremstyle{definition}
\newtheorem{lem}[thm]{Lemma}
\theoremstyle{definition}
\newtheorem{ex}[thm]{Example}
\theoremstyle{definition}
\newtheorem{conj}[thm]{Conjecture}
\theoremstyle{definition}
\newtheorem*{rem}{Remark}

\newcommand{\Rom}[1]
    {\MakeUppercase{\romannumeral #1}}
\newcommand{\C}[1]{(\mathbb{C}^*)^#1}
\newcommand{\ldp}{log del pezzo }
\newcommand{\mb}[1]{\mathbb{#1}}
\newcommand{\Hi}{Hirzebruch surface }
\newcommand{\minres}{minimal resolution }
\newcommand{\LJ}{Looijenga pair }
\newcommand{\ra}{\rightarrow}
\newcommand{\wt}[1]{\widetilde{#1}}

\graphicspath{ {images/} }

\begin{document} 


\section{Log extremal cyclic extractions}


We wish to classify the extremal cyclic extractions of a given log terminal singularity. We start with the case of a cyclic quotient singularity. Given a cyclic quotient singularity $S$ with minimal resolution $\wt{S}$ with exceptional curve $E_1 \dots E_n$ with $E_i^2 = -a_i$. Here we allow we separate the case $n=0$ which corresponds to $\mathbb{A}^2$. Let $\widetilde{S}$ be the minimal resolution of $S$.

\begin{dfn}
An \emph{extremal cyclic extraction} is a proper birational morphism $\phi : \: X \ra S$ where
\begin{itemize}

\item $S$ is the germ of a log terminal singularity
\item $\rho(X) = \rho(S) + 1$
\item The map $\phi$ is $-K_X$ ample
\item $X$ has at worst cyclic quotient singularities
\end{itemize}
\end{dfn}
 
 We are primarily interested in the case of surfaces, where this involves contracting a smooth curve $C$ isomorphic $\mb{P}^1$ going through at least one cyclic quotient singularity. Let $\wt{S}$, $\wt{X}$ be the minimal resolutions of $S$ and $X$ respectively. By the property of $\phi$ being $-K_X$ ample we note that the strict transform of $C \subset \wt{X}$ is a $-1$ curve. This follows from the map being $-K_X$ ample. 
 
 
 We also note that in dimension two we have a map $\wt{\phi} : \: \wt{X} \ra \wt{S}$ this follows via stein factorisation.
 
\begin{lem}\label{onecurve}
Using the previous notation, the $\wt{X}$ has exactly one $-1$ curve.
\end{lem}
\begin{proof}
We note that the map fits into the following diagram:
\[
% https://tikzcd.yichuanshen.de/#N4Igdg9gJgpgziAXAbVABwnAlgFyxMJZABgBpiBdUkANwEMAbAVxiRAA0B9YgAgF4eAHUEB3HMHYBfEJNLpMufIRQBGclVqMWbLiplyQGbHgJEATOur1mrRCGEBjKBBwJZ840qIBmS5ps6nGD8QqLiAMrS7oYKJsrIvioa1tp24foeiqYoZElWWrYcMhowUADm8ESgAGYAThAAtkhkIDgQSGr+qfaCaAAWWJx60XWNHdRtSGYj9U2IFq3tiL5dhcL9g4QzY8sTSwAs23MArHtI+-kBdusDGSCjcy2TiMeSFJJAA
\begin{tikzcd}
\wt{X}  = X_0 \arrow[r, "\phi_1"] \arrow[d] & X_1 \arrow[r, "\phi_2"] & \cdots \arrow[r, "\phi_n"] & X_n = \wt{S} \arrow[d] \\
X \arrow[rrr, "\phi"]                      &               &                            & S                     
\end{tikzcd}
\]
Here the maps $\phi_i$ are the contraction of a $-1$ curve. Then if $X_0$ has more than one $-1$ curve then as $S$ has none there will be an $i$ such that $X_i$ has two $-1$ curves and $X_{i+1}$ has one $-1$ curve. This indicates the two minus one curves on $X_i$ must be adjacent. Hence when we contract one we must have a $0$ curve. This being a projective curve means that in $\wt{S}$ that it is either a negative curve or has been contracted to a point. This is a contradiction. The fact that there has to be at least one $-1$ curve follows as it is constructed by a series of blowups.
\end{proof}
 
\begin{lem}
Given a cyclic quotient singularity $S$ with toric resolution $\wt{S}$ then every cyclic log extraction $X$ has minimal resolution $\wt{X}$ with intersections with the following form:
\[
% https://tikzcd.yichuanshen.de/#N4Igdg9gJgpgziAXAbVABwnAlgFyxMJZABgBpiBdUkANwEMAbAVxiRDoH0BGEAX1PSZc+Qii7kqtRizacATHwEgM2PASJyJ1es1aIQAHQMBjKBBwJ+g1SKIBmLVN2yOWAAQBqNwGtF14eooACyOOjL6RqbmcG5+ykJqosgArKHSeuwcwFgAtFy8cSoBSQBsac76nFiFCbYoDlySYRk8VvE2gcgOck3pbAptRYn2pHa9FYYGNGYWNR1JDkHj4SADkjBQAObwRKAAZgBOEAC2SGQgOBBI4iAAFjB0UGyQYKxthyfX1JdImncPT30LzeSg+p0Qfx+iAc-0ezwIIP2R3BMKhIVhgPACLiYKQ6KhqQx8NeOORSEJULKRKB2PeZOh3yuiAA7NR7nCaSS6Z9EABORnXc7szHA0k8-kXJkADjZAOJiJAuMQMslSFZ1KxXIovCAA
\begin{tikzcd}
a_1' \arrow[r, no head] & a_2' \arrow[r, no head] & \cdots \arrow[r, no head] & a_i' + k \arrow[r, no head] \arrow[d, no head] & \cdots  \arrow[r, no head] & a_{n-1}' \arrow[r, no head] & a_n' \\
                       &                        &                           & 1                                             &                            &                            &     \\
                       &                        &                           & 2 \arrow[u, no head]                          &                            &                            &     \\
                       &                        &                           & \vdots \arrow[d, no head] \arrow[u, no head]  &                            &                            &     \\
                       &                        &                           & 2                                             &                            &                            &    
\end{tikzcd}
\]
Here the number of $-2$ curves is $k-1$. We note that $k$ can be equal to zero.
\end{lem}

\begin{proof}
Let $\widetilde{S}$ be the minimal resolution of $S$. Let $\pi : X \rightarrow S$ be the log extraction, with $\widetilde{X}$ being the minimal resolution. By lemma ~\ref{onecurve} every  blowup, except the first, is at a point on the unique $-1$ curve. Our sequence of blowups can be split into the ones that keep all the torus actions and the ones that don't. After the toric blowups we are are left with a configuration $a_1' \dots a_{n'}'$. The first non toric blowup is centered on a point lieing on one of the negative curves, call this the $E_i$ curve. We note that if we have done any toric blowups of $\wt{S}$ then there is only choice of curve $E_i$ and $a_i' = 1$. If our next blowup is not the intersection of the $-1$ curve and one of the $E_i$ curve then the $E_i$ curve is trivalent, and our resulting singularity will clearly not be cyclic quotient. Hence there is only one choice of point we can blowup, by repeating this logic repeatedly we end up with the above curve configuration.
\end{proof}

\begin{rem}
We note in the language of toric varieties our cyclic quotient singularity can be described as cone $\sigma \subset N$ with $N$ the standard toric lattice. Then every cyclic extraction can be denoted by $(v, \, k)$ where $v \in N$ and $k \in \mathbb{Z}_{\geq 0}$ by the following process. The choice of $v$ determines a weighted blowup, giving rise to an exceptional curve $C$, the number $k$ then determines how many times you blow up this curve. After these blowups, to guarantee $-K_X$ being ample, we need to contract all the negative curves except the $-1$ curve.
\end{rem}

Now given a non cyclic quotient singularity $S$ a similar process occurs. By \cite{Br} we have a unique trivalent curve, to guarantee a cyclic quotient, one these three points must be blown up at least once. From this rather than a Du Val singularity arising you have a singularity of higher index. This will implie that these extractions do not have equivariant toric degenerations. We can write all of these extractions down as complexity one varieties. In the cyclic case they are formed by the glueing of two polyhedral divisors 
\[
\begin{array}{l}
\mathcal{D}_1 = [\frac{a}{b}, \infty) \otimes P_1 + [\frac{c}{d}, \infty) \otimes P_3 \\
\mathcal{D}_2 =  \emptyset \otimes P_1 + [0, n] \otimes P_2 + \emptyset \otimes P_3
\end{array}
\]
and in the non cyclic case 
\[
\begin{array}{l}
\mathcal{D}_1 = [\frac{a}{b}, \infty) \otimes P_1 + [n, \infty) \otimes P_2 + [\frac{c}{d}, \infty) \otimes P_3 \\
\mathcal{D}_2 =  \emptyset \otimes P_1 + [\frac{e}{f}, n] \otimes P_2 + \emptyset \otimes P_3
\end{array}
\]
All polyhedral divisors are over a base curve of $\mathbb{P}^1$. We see that if it admitted an equivariant toric degeneration there would be a way of combining two of the $P_i$. However the condition for it to be a valid deformation is that at least one of the two ends of the intervl are integers, and this cannot happen in the non cyclic quotient case. In the case arising from a cyclic quotient singularity we can take the minkowski sum of the polyhedral divisors $\frac{a}{b} \otimes P_1$ with $[0, n] \otimes P_2$. This leads us to the toric configuration 
\[
\begin{array}{l}
\mathcal{D}_1 = [ n + \frac{a}{b}, \infty) \otimes P_1 + [\frac{c}{d}, \infty) \otimes P_3 \\
\mathcal{D}_2 =  [\frac{a}{b}, n + \frac{a}{b}] \otimes P_1
\end{array}
\]
\newline
\begin{thm}
When it exists, given the above toric degeneration of a log terminal extraction then the map extends to a map of 3-folds. With $\mathcal{X} \rightarrow \mathbb{P}^1 \times S$.
\end{thm}
\vspace{0.1cm}
Given the assumptions above we can assume that $S$ is a $\frac{1}{r}(1,s)$ singularity and has a fan $\Sigma$ with rays $(a,b)$ and $(c-kd,-d)$ with $a,b,c,d  > 0$. We can also assume that the ray $(1,0)$ corresponds to $E$ in the minimal resolution. We also note that $r$ is equal to the determinant of the rays, $ad - b(c-kd)$. 
\\
\\
We note that $X$ has a torus acting on it. This means that it can be written as a polyhedral divisor $\mathcal{S}$.
\begin{comment}
\begin{figure}[htbp]
\psset{unit=0.95cm}
\begin{pspicture}(0,-6)(12,0)
%\psgrid(0,0)(0,-8)(12,0)
\psframe[linecolor=white](0.5,-4.5)(3.5,-1.5)


\psline{<-|}(6,-3)(7.5,-3)
\psline{|->}(7.5,-3)(10,-3)
%\uput*[270](8,-3){$0$}
\rput[bl]{0}(11,-3){$\mathcal{S}_1$}
\uput*[270](7.6,-3.1){${\tiny \frac{a}{b}}$}

\psline{<-|}(6,-1.8)(7.25,-1.8)
\psline{-|}(7.25,-1.8)(8,-1.8)
\psline{->}(8,-1.8)(10,-1.8)
\uput*[270](7.2,-1.9){${\tiny {0}}$}
\uput*[270](8,-1.9){${\tiny{k}}$}
\rput[bl]{0}(11,-1.8){$\mathcal{S}_0$}
\rput[bl]{0}(9,-1.6){$\mathcal{D}_{\sigma_0}$}
\rput[bl]{0}(7.3,-1.6){$\mathcal{D}_{\sigma_1}$}


\psline{<-|}(6,-4.2)(9,-4.2)
\psline{|->}(9,-4.2)(10,-4.2)
\uput*[270](8.9,-4.3){${\tiny \frac{c-kd}{d}}$}
\rput[bl]{0}(11,-4.2){$\mathcal{S}_{\infty}$}
\rput[bl]{0}(9,-4){$\mathcal{D}_{\sigma_0}$}
\rput[bl]{0}(8,-5.5){$\mathcal{S}$}

\psline{|->}(5,-3)(5,-1)
\psline{|->}(5,-3)(5,-5)
%\qdisk(5,-1.8){1pt}
%\qdisk(5,-4.2){1pt}
%\qdisk(5,-3){1.5pt}
\rput[bl]{0}(4.5,-5.5){$Y=\mathbb{P}^1$}


\end{pspicture}
\caption{Divisorial fan associated to $X$.}
\end{figure}
\end{comment}

Here the tail fan is $\mathbb{Z}_{\geq 0}$. When constructing the equivariant toric degeneration, we take the Minkowski sum of $\frac{c-kd}{d}$ and the cone $\left[0, k\right]$. After summation this is the toric variety with rays $(a,b)$, $(c,-d)$, $(c-kd,-d)$. Call this $X_\Sigma$. The cone $(c,-d)$, $(c-kd,-d)$ is a $T$-singularity. The cone  $(a,b)$, $(c,-d)$ is a $\frac{1}{t}(1, u)$ singularity with once again $t = bc + ad$. Labeling these three rays $v_1, v_2, v_3$ we get the relation $kd^2 v_1 - r v_2 + t v_3 = 0$. This implies that the Cox Ring  $\mathcal{R}(X_\Sigma)$ is $\mathbb{A}^3_{<x,y,z>}$ with a quotient of $\mathbb{C}^*$ with weights $(kd^2, -r, t)$ and a finite group action $\mathbb{\mu}$. It is easy to show that $|\mathbb{\mu}| = \text{hcf(b,d)} = e$ as $(x, ey)$ is clearly a sub lattice which contains all the vertices and $(1,0)$ is in the lattice as $b$ and $d$ are coprime. This is a well defined quotient except along $x = z= 0$. To construct the deformation, we take the $d$-fold veronese embedding getting
\[
\frac{\mathbb{C}[y_1, y_2, y_3,  y_4]}{y_2^d -y_3 y_4} \text{  with weights } (kd, kb, -r, t)
\]

Here the $b$ occurs as $t-r = kdb$. We can now construct the deformation family by the following equation

\[
\frac{\mathbb{C}[y_1, y_2, y_3,  y_4]}{\lambda y_1^b  + \mu y_2^d - y_3 y_4} \text{  with weights } (kd, kb, -r, t)
\]

At $\lambda = 0$ this is our original variety. At $\mu = 0$ we get the variety corresponding to the Minkowski sum of the cones $\frac{a}{b}$ and the cone $\left[ 0, 1 \right]$. This is the toric variety with rays $(c-d,-d), \, (a+b, b), \, (a,b)$. Note that the index of the sublattice generated by these rays is still equal to hcf$(b, d)$. All that remains is to show that this is the desired complexity one variety. From the above polyhedral divisor we get that $\mathcal{R}(X) =\frac{\mathbb{C}[y_1, y_2, y_3,  y_4]}{\lambda y_1^b  + \mu y_2^d - y_3 y_4}$. We now have to calculate the weights of the torus action on it. The Weil divisors on $X$ satisfy the relations given by the rows of the following matrix. 
\[
 \left(
 \begin{array}{cccc}
b & 0 & -1 & -1  \\
0 & c & -1 & -1 \\
a & d & 0  & k \\
\end{array}
\right) 
\]
To calculate the grading is equivalent to finding a relation between the columns of the matrix. It is easy to verify that the weights $kd,kb,-r,t$ give the corresponding column sum of 0. To verify that the same finite group acts on the fiber we see that if we do Gaussian elimination. We get a row $(d, -b, 0 ,0)$ if these two numbers are not coprime this means that we have torsion in the class of size hcf$(b,d)$. So $\mathbb{\mu}$ action extends across the family. 
\\
\\
We now classify cyclic log fano extractions on surfaces.
\begin{lem}
Let $f: \, X \rightarrow S$ be a cyclic log fano extarction. Then $S$ has to be a cyclic singularity and $f$ has to be the map as described above. This results in potentially two cyclic quotient singularities. One of them is a general $\frac{1}{r} (1, a)$ and the other is of type $A_n$.
\end{lem}
\end{document}